!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="06ac53b1-6fe3-4049-a1f4-216aded2f443",e._sentryDebugIdIdentifier="sentry-dbid-06ac53b1-6fe3-4049-a1f4-216aded2f443")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[93230],{44508:function(e,t,r){"use strict";r.d(t,{Z:function(){return O}});var n=r(32971),i=r(94713),o=r(21841),a=r.n(o),u=r(15266),l=r(8512),c=r.n(l),s=r(52106),d=r.n(s),f=new(c())({id:"replay-3ed09143d927d7e936efca63f9da9d7c",use:"replay-3ed09143d927d7e936efca63f9da9d7c-usage",viewBox:"0 0 24 24",content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="replay-3ed09143d927d7e936efca63f9da9d7c"><path d="M12 5V2.21c0-.45-.54-.67-.85-.35l-3.8 3.79c-.2.2-.2.51 0 .71l3.79 3.79c.32.31.86.09.86-.36V7c3.73 0 6.68 3.42 5.86 7.29-.47 2.27-2.31 4.1-4.57 4.57-3.57.75-6.75-1.7-7.23-5.01-.07-.48-.49-.85-.98-.85-.6 0-1.08.53-1 1.13.62 4.39 4.8 7.64 9.53 6.72 3.12-.61 5.63-3.12 6.24-6.24C20.84 9.48 16.94 5 12 5z" /></symbol>'});d().add(f);var p=r(33256),v=r(1227),m=r.n(v),g=r(48282),h=["children","isPreview"];function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function b(e){var t,r=e.progress,n=e.error,o=e.hasThumbnail;return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("div",{style:{"--progress":"".concat(r||0,"%")},className:a()(m().overlay,(t={},(0,i.Z)(t,m().error,!!n),(0,i.Z)(t,m().hasThumbnail,o),t))}),!!n&&(0,g.jsx)(p.Z,{symbol:n.allowRetries?f:u.jj,className:m().errorIcon,fill:"strawberry-dark",width:30,height:30})]})}function O(e){var t=e.children,r=e.isPreview,o=(0,n.Z)(e,h);return(0,g.jsxs)("div",{className:a()(m().container,(0,i.Z)({},m().preview,r)),children:[t,(0,g.jsx)(b,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach(function(t){(0,i.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},o))]})}},79199:function(e,t,r){"use strict";r.d(t,{Z:function(){return m}});var n=r(5338),i=r(28332),o=r.n(i),a=r(21841),u=r.n(a),l=r(18529),c=r(12100),s=r(65605),d=r(46659),f=r.n(d),p=r(998),v=r(48282);function m(e){var t,r=e.children,i=e.id,a=e.className,d=e.onFileSelected,m=(0,p.Z)().addFilesIfPermitted,g=(0,s.ZP)().user,h=(t=(0,n.Z)(o().mark(function e(t){var r;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m(Array.from(null!==(r=t.target.files)&&void 0!==r?r:[]));case 2:e.sent>0&&(null==d||d()),t.target.value="";case 5:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)}),y=(0,l.useMemo)(function(){var e,t=null===(e=null==g?void 0:g.meta.policy.media.allow_video_uploads)||void 0===e||e;return(0,c.kW)(t)},[null==g?void 0:g.meta.policy.media.allow_video_uploads]);return(0,v.jsxs)("label",{htmlFor:"media-input-".concat(i),className:u()(a,f().mediaButton),children:[r,(0,v.jsx)("input",{type:"file",id:"media-input-".concat(i),className:f().fileInput,onChange:h,accept:y.join(", "),multiple:!0})]})}},15889:function(e,t,r){"use strict";r.d(t,{S:function(){return p},Z:function(){return v}});var n=r(5338),i=r(28332),o=r.n(i),a=r(18529),u=r(12100),l=r(91341),c=r(13462),s=r(87360),d=r(36985);function f(){return(f=(0,n.Z)(o().mark(function e(t){var r,n,i,a,l,d,f,p,v,m,g;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.target){e.next=4;break}return e.abrupt("return",t.target);case 4:return e.prev=4,r=t.file.type.split("/")[1],e.next=8,(0,c.l)(u.kb,[r]);case 8:if(i=(n=e.sent).response,a=n.status,l=n.ok,d=n.errorMessage,!(i&&l)){e.next=21;break}return p=(f=i[0]).fields,v=f.upload_url,m=f.medium_id,g=new FormData,Object.keys(p).forEach(function(e){g.append(e,p[e])}),g.append("file",t.file),e.abrupt("return",{body:g,uploadUrl:v,mediumId:m});case 21:if(422!==a){e.next=25;break}return e.abrupt("return",{reason:s.Z.FILE_UNPROCESSABLE,allowRetries:!1});case 25:if(!d){e.next=29;break}return e.abrupt("return",{reason:s.Z.OTHER,allowRetries:!0,errorMessage:d});case 29:return e.abrupt("return",{reason:s.Z.NO_UPLOAD_URL,allowRetries:!0});case 30:e.next=36;break;case 32:return e.prev=32,e.t0=e.catch(4),Sentry.captureException(e.t0),e.abrupt("return",{reason:s.Z.NO_UPLOAD_URL,allowRetries:!0});case 36:case"end":return e.stop()}},e,null,[[4,32]])}))).apply(this,arguments)}function p(e,t){var r=(0,a.useState)(0),n=r[0],i=r[1];return(0,a.useEffect)(function(){var r=t.find(function(t){return t.fileId===e.id});return r?i(r.progress()):i(e.status===s.D.COMPLETED?100:0),null==r?void 0:r.listen(i)},[e.id,e.status,t]),n}function v(e){var t,r,i=e.state,a=e.asset,u=e.beginUpload,c=e.endUpload,p=0,v={fileId:i.id,listeners:[],progress:function(){return p},listen:function(e){return v.listeners.includes(e)||v.listeners.push(e),function(){var t=v.listeners.indexOf(e);t>=0&&v.listeners.splice(t,1)}},end:function(){var e;null===(e=r)||void 0===e||e.abort()},begin:(t=(0,n.Z)(o().mark(function e(){var t,n,u;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.f5)(a);case 2:if(!e.sent){e.next=6;break}return c(i.id,{reason:s.Z.MIN_RESOLUTION,allowRetries:!1},void 0),(0,l.M)({category:"media_upload_added_error",action:"min_resolution",label:(0,d.hy)(null===(t=a.data)||void 0===t?void 0:t.dimensions)||void 0,property:(0,d.BS)(i.file)}),e.abrupt("return");case 6:return e.next=8,function(e){return f.apply(this,arguments)}(i);case 8:if(!("reason"in(n=e.sent))){e.next=13;break}return u=n,c(i.id,u,void 0),e.abrupt("return");case 13:return e.next=15,new Promise(function(e){(r=new XMLHttpRequest).upload.addEventListener("progress",function(e){e.lengthComputable?(p=e.loaded/e.total*100,v.listeners.forEach(function(e){return e(p)})):Sentry.captureMessage("Received upload progress event without computable length")}),r.open("POST",n.uploadUrl),r.onabort=function(){e(),c(i.id,"cancelled",n)},r.onerror=function(){e(),c(i.id,{reason:s.Z.UPLOAD_FAILURE,allowRetries:!0},n)},r.onload=function(){e(),r.status<200||r.status>=400?c(i.id,{reason:s.Z.UPLOAD_STATUS,allowRetries:!0},n):c(i.id,"success",n)},r.send(n.body)}).catch(function(e){Sentry.captureException(e),c(i.id,{reason:s.Z.UPLOAD_FAILURE,allowRetries:!0},n)});case 15:case"end":return e.stop()}},e)})),function(){return t.apply(this,arguments)})};return u(i.id,v),v}},17185:function(e,t,r){"use strict";function n(){var e=[],t=!1;return{enqueue:function(r,n){return new Promise(function(i,o){e.push({promise:r,resolve:i,reject:o,priority:n}),e.sort(function(e,t){return e.priority-t.priority}),function r(){if(!t){var n=e.shift();if(n)try{t=!0,n.promise().then(function(e){t=!1,n.resolve(e),r()}).catch(function(e){t=!1,n.reject(e),r()})}catch(e){t=!1,n.reject(e),r()}}}()})},clear:function(){e.length=0}}}r.d(t,{h:function(){return n}})},69882:function(e,t,r){"use strict";r.d(t,{Lx:function(){return D},Dg:function(){return Z},ZP:function(){return U},et:function(){return x}});var n=r(94713),i=r(5338),o=r(28332),a=r.n(o),u=r(18529),l=r(73067),c=r(66667),s=function(){function e(){var t=this;(0,l.Z)(this,e),this.promise=new Promise(function(e,r){t.resolveFunc=e,t.rejectFunc=r})}return(0,c.Z)(e,[{key:"resolve",get:function(){return this.resolveFunc}},{key:"reject",get:function(){return this.rejectFunc}}]),e}(),d=r(36985),f=r(17185);function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var m=new Map,g=null,h=(0,f.h)(),y=h.enqueue,b=h.clear;function O(e,t,r){var n,o,u={key:t,contentType:(0,d.BS)(e),promise:r.then((o=(0,i.Z)(a().mark(function t(r){return a().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!m.has(e)){t.next=5;break}return u.data=r,t.abrupt("return",r);case 5:return t.abrupt("return",v(v({},r),{},{blobUrl:""}));case 6:case"end":return t.stop()}},t)})),function(e){return o.apply(this,arguments)}),function(e){throw Sentry.captureException(e),e})};return m.has(e)?null===(n=m.get(e))||void 0===n||n.push(u):m.set(e,[u]),u}function w(e){var t;null===(t=m.get(e))||void 0===t||t.forEach(function(e){var t;null!==(t=e.data)&&void 0!==t&&t.blobUrl&&URL.revokeObjectURL(e.data.blobUrl)}),m.delete(e)}function _(e,t){var r,n;return null!==(r=null===(n=m.get(e))||void 0===n?void 0:n.find(function(e){return e.key===t}))&&void 0!==r?r:null}function j(){return(j=(0,i.Z)(a().mark(function e(t,r){var n,i,o,u,l;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.promise;case 2:n=e.sent.blobUrl,i=new s;try{o=function(e){var n=e.currentTarget,o="videoWidth"in n,a=o?n.videoWidth:n.width,u=o?n.videoHeight:n.height;a>r&&(u*=r/a,a=r),g||(g=document.createElement("canvas")),g.width=a,g.height=u,function e(t,r,n,i,o){var a=i.getContext("2d",{alpha:!0,willReadFrequently:!0});a.clearRect(0,0,i.width,i.height),a.drawImage(n,0,0,i.width,i.height),i.toBlob(function(u){u?a.getImageData(0,0,1,1).data[3]>0?t.resolve(u):o<5?setTimeout(function(){return e(t,r,n,i,o+1)},50*Math.pow(2,o)):t.reject("Render failed"):t.reject(Error("blob is null"))},"image/jpg")}(i,t,n,g,0)},"video"===t.contentType?((u=document.createElement("video")).src=n,u.preload="metadata",u.currentTime=2,u.onloadeddata=o,u.onerror=function(){return i.reject(u.error)}):((l=new Image).src=n,l.onload=o,l.onerror=function(e){return i.reject(e.toString())})}catch(e){i.reject(e)}return e.abrupt("return",i.promise);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function P(e){var t=_(e,"source");if(t)return t;var r=URL.createObjectURL(e),n=(function(e,t){var r=new s;try{if("photo"===t){var n=new Image;n.src=e,n.onload=function(){r.resolve({width:n.naturalWidth,height:n.naturalHeight})},n.onerror=function(e){Sentry.captureMessage("measureAssetBlob: Image load failed",{extra:{event:e}}),r.resolve({width:0,height:0})},n.complete&&n.onload(null)}else{var i=document.createElement("video");i.src=e,i.preload="metadata",i.currentTime=2,i.onloadeddata=function(){r.resolve({width:i.videoWidth,height:i.videoHeight})},i.onerror=function(e){Sentry.captureMessage("measureAssetBlob: Video load failed",{extra:{event:e}}),r.resolve({width:0,height:0})}}}catch(e){Sentry.captureException(e),r.resolve({width:0,height:0})}return r.promise})(r,(0,d.BS)(e)).then(function(e){return{blobUrl:r,dimensions:e}});return O(e,"source",n)}function E(e,t){var r=null!=t?t:{},n=r.maxWidth,o=r.priority,u=_(e,null!=n?n:"source");if(u)return u;if(!n)return P(e);var l=y((0,i.Z)(a().mark(function t(){var r,i,o,u,l;return a().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=n*(window.devicePixelRatio||1),i=P(e),t.next=5,function(e,t){return j.apply(this,arguments)}(i,r);case 5:return o=t.sent,l=(u=i.data.dimensions).width/u.height,t.abrupt("return",{blobUrl:URL.createObjectURL(o),dimensions:{width:n,height:n/l}});case 9:case"end":return t.stop()}},t)})),o||1);return O(e,n,l)}function U(e,t){var r=(0,u.useState)(null),n=r[0],i=r[1];return(0,u.useEffect)(function(){if(e){var r,n=E(e,t);null!==(r=n.data)&&void 0!==r&&r.blobUrl?i(n.data):n.promise.then(i,Sentry.captureException)}},[e,t]),n}function x(){return(0,u.useCallback)(function(e,t){return E(e,t)},[])}function Z(e){w(e)}function D(){Array.from(m.keys()).forEach(function(e){w(e)}),b(),g=null}},998:function(e,t,r){"use strict";r.d(t,{Z:function(){return b}});var n,i=r(5338),o=r(28332),a=r.n(o),u=r(74922),l=r.n(u),c=r(33106),s=r(18529),d=r(12100),f=r(92436),p=r(65605),v=r(91341),m=r(13884),g=r(36985);function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var y={addFilesIfPermitted:(n=(0,i.Z)(a().mark(function e(){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",0);case 1:case"end":return e.stop()}},e)})),function(){return n.apply(this,arguments)}),fileHoverHandler:function(){},fileDropHandler:function(){},fileLeaveHandler:function(){},fileHover:!1};function b(){var e=(0,c.Z)().t,t=(0,p.ZP)().user,r=(0,s.useState)(!1),n=r[0],o=r[1],u=(0,s.useMemo)(function(){return l()(o,50,{leading:!0,trailing:!0})},[]),b=(0,m.b)(),O=b.browserIsSupported,w=b.files,_=b.addFiles,j=(0,f.ZP)().addAlert,P=(0,s.useMemo)(function(){var e,r=null!==(e=null==t?void 0:t.meta.policy.media.daily_upload_limit)&&void 0!==e?e:{},n=r.max,i=r.remaining,o=null!=i?i:0,a={message:"too_many_files",maxLimit:100,remaining:100,trackingEventAction:"too_many_files"};return t&&n&&(o?o<100&&(a.message="upload_limit",a.maxLimit=n,a.remaining=o,a.trackingEventAction="upload_limit"):(a.message="upload_limit_exhausted",a.remaining=o,a.trackingEventAction="upload_limit")),a},[t]);if(!O)return y;function E(e){if(e.stopPropagation(),e.preventDefault(),!(0,g.nq)(e)){e.dataTransfer.dropEffect="none";return}"drop"===e.type?u(!1):u(!0),e.dataTransfer.dropEffect="copy"}function U(e){return x.apply(this,arguments)}function x(){return(x=(0,i.Z)(a().mark(function r(n){var i,o,u,l,c,s,f,p,m,y,b,O,E;return a().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=(null==t?void 0:t.meta.policy.media.allow_video_uploads)!==!1,o=(0,d.kW)(!0),u=(0,d.kW)(i),l="",c=n.filter(function(r){if(!u.includes(r.type)){o.includes(r.type)?l||(l=e("upload:error.disabled_file_type")):l=e("upload:error.unsupported_file_type");var n=r.name.split(".").slice(-1)[0];return(0,v.M)({category:"media_upload_added_error",action:"unsupported_file_type",label:n,property:null==t?void 0:t.id}),!1}return!Object.values(w).some(function(e){return e.file.name===r.name})}),l&&j({type:"error",message:l}),0!==c.length){r.next=8;break}return r.abrupt("return",0);case 8:s=[],f=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return h(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return h(e,t)}}(e))){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){u=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw o}}}}(c),r.prev=10,f.s();case 12:if((p=f.n()).done){r.next=26;break}if(m=p.value,"video"!==(0,g.BS)(m)){r.next=23;break}return r.next=18,(0,g.PS)(m);case 18:(y=r.sent).analyticsEventAction&&(0,v.M)({category:"media_upload_added_error",action:y.analyticsEventAction,label:m.name,property:null==t?void 0:t.id}),y.isValid?s.push(m):y.errorMessageKey&&j({type:"error",message:"".concat(m.name,": ").concat(e(y.errorMessageKey)),timeoutMs:5e3}),r.next=24;break;case 23:s.push(m);case 24:r.next=12;break;case 26:r.next=31;break;case 28:r.prev=28,r.t0=r.catch(10),f.e(r.t0);case 31:return r.prev=31,f.f(),r.finish(31);case 34:if(0!==s.length){r.next=36;break}return r.abrupt("return",0);case 36:if(b=Object.values(w),!((O=s.length+b.length)>P.remaining)){r.next=48;break}if(E={category:"media_upload_added_error",action:P.trackingEventAction,property:(0,g.x1)([].concat(s,b))},"too_many_files"===P.trackingEventAction?(E.label="limit_reached",E.value=null!=t&&t.id?parseInt(t.id):void 0):"upload_limit"===P.trackingEventAction&&(E.label=O.toString(),E.value=P.remaining),(0,v.M)(E),j({type:"error",message:e("upload:error.".concat(P.message),{limit:P.maxLimit,remaining:P.remaining,count:P.remaining})}),!(b.length<P.remaining)){r.next=47;break}s.length=P.remaining-b.length,r.next=48;break;case 47:return r.abrupt("return",0);case 48:return _(s),r.abrupt("return",s.length);case 50:case"end":return r.stop()}},r,null,[[10,28,31,34]])}))).apply(this,arguments)}return{addFilesIfPermitted:U,fileHoverHandler:E,fileDropHandler:function(e){var t=Array.from(e.dataTransfer.files);E(e),U(t)},fileLeaveHandler:function(e){e.stopPropagation(),e.preventDefault(),u(!1)},fileHover:n}}},69334:function(e,t,r){"use strict";r.d(t,{Z:function(){return _}});var n=r(94713),i=r(32971),o=r(94809),a=r(90227),u=r(33106),l=r(18529),c=r(85906),s=r(12100),d=r(92436),f=r(69732),p=r(91341),v=r(13462),m=r(24856),g=r(87360),h=r(13884),y=r(36985),b=["challenges","tags"];function O(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function w(e,t,r){var n=e.map(function(e){var n=r(e.metadata[t]);return n.sort(),n.join("<|>")});if(!(n.length>1))return!0;var i=(0,o.Z)(n),a=i[0];return i.slice(1).every(function(e){return e===a})}function _(e){var t=(0,h.b)().files,r=(0,u.Z)(),o=(0,a.useRouter)(),_=(0,l.useState)(!1),j=_[0],P=_[1],E=(0,d.ZP)().addAlert,U=(0,f.Z)().setPostUploadState,x=(0,l.useMemo)(function(){var e=Object.values(t);return{tags:w(e,"tags",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return null==e?void 0:e.map(function(e){return e.name})}),location:w(e,"location",function(e){return e?[e.google_place_id]:[]}),challenges:w(e,"challenges",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return null==e?void 0:e.map(function(e){return e.value})})}},[t]),Z=(0,l.useMemo)(function(){return Object.values(t).reduce(function(e,t){return t.status===g.D.COMPLETED?++e.success:t.status===g.D.FAILED&&++e.failed,e},{success:0,failed:0})},[t]),D=(0,l.useMemo)(function(){return Object.values(t).filter(function(e){return e.status===g.D.COMPLETED})},[t]);return{submitHandler:(0,l.useCallback)(function(t){var a=(null!=t?t:{}).redirect,u=void 0===a||a;P(!0);var l=D.map(function(e){var t=e.dimensions,r=e.target,o=(void 0===r?{}:r).mediumId,a=e.metadata,u=a.challenges,l=a.tags,c=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?O(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({id:o},(0,i.Z)(a,b));return null!=l&&l.length&&(c.tags=null==l?void 0:l.map(function(e){return e.name})),null!=u&&u.length&&(c.challenge_ids=null==u?void 0:u.map(function(e){return e.value})),t&&(c.width=t.width,c.height=t.height),c});(0,v.l)(s.$o,{media:l}).then(function(t){if(t){if(U(D.reduce(function(t,r){var n,i,o,a=r.file,u=r.metadata,l=(0,y.BS)(a);t.mediaType?t.mediaType!==l&&(t.mediaType="both"):t.mediaType=l;var s=null!==(n=e.attributes.media_count)&&void 0!==n?n:0,d=(null!==(i=null===(o=u.challenges)||void 0===o?void 0:o.length)&&void 0!==i?i:0)>0,f=(0,c.A2)(e);return 0===s?(t.showAfterUploadModal=!0,t.flow="first-upload"):f?(t.showAfterUploadModal=!0,t.flow="community-feed-prompt"):d&&(t.showAfterUploadModal=!0,t.flow="has-challenge"),t},{showAfterUploadModal:!1,flow:"first-upload",mediumCount:D.length,mediaType:null})),D.forEach(function(t){var r,n,i,a=t.file,u=t.metadata,l=t.target,c=t.metadataExtraction,s=(0,y.BS)(a),d=[u.title&&"title",(null===(r=u.tags)||void 0===r?void 0:r.length)&&"tags",u.location&&"location",(null===(n=u.challenges)||void 0===n?void 0:n.length)&&"challenge"].filter(function(e){return!!e});(0,p.Z)({name:"upload",id:l.mediumId,tags:!!(null!==(i=u.tags)&&void 0!==i&&i.length),title:!!u.title,location:!!u.location,challenges:!!u.challenges,challenge_cta:!!o.query.challengeQuery,content_type:s}),(0,p.M)({category:"upload",action:d.join(", "),label:e.id,property:s,value:D.length}),(null!=c&&c.title||null!=c&&c.tags||null!=c&&c.latitude||null!=c&&c.longitude||null!=c&&c.errored)&&(0,p.M)({category:"upload",action:"media_upload_exif_extracted",label:null==l?void 0:l.mediumId,property:[null!=c&&c.title?"title":null,null!=c&&c.tags?"tags":null,null!=c&&c.longitude?"long":null,null!=c&&c.latitude?"lat":null,"exif_status: ".concat(c.errored?"failure":"success")].filter(function(e){return e}).join(", ")})}),u){var n=(0,m.Z)(o,r,e);o.push(n)}Z.success>0&&E({type:"success",message:r.t("upload:success",{count:Z.success}),timeoutMs:3e3})}}).catch(function(){P(!1),E({type:"error",message:r.t("upload:failure"),timeoutMs:3e3})})},[E,D,Z.success,e,r,o,U]),successItems:D,successCount:Z.success,failureCount:Z.failed,formSubmitted:j,consistency:x}}},35099:function(e,t,r){"use strict";r.d(t,{Z:function(){return v}});var n=r(5338),i=r(28332),o=r.n(i),a=r(18529),u=r(91341),l=r(15889),c=r(69882),s=r(87360),d=r(13884),f=r(36985);function p(){return(p=(0,n.Z)(o().mark(function e(t,r,n){var i,a,l;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.promise;case 2:a=e.sent.dimensions,l={category:"media_upload_added",action:(0,f.Fx)(t.file),property:(0,f.BS)(t.file),value:n,label:null!==(i=(0,f.hy)(a))&&void 0!==i?i:void 0},(0,u.M)(l);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function v(){var e=(0,d.b)(),t=e.files,r=e.fileOrdering,n=e.beginUpload,i=e.endUpload,o=(0,c.et)(),u=(0,a.useMemo)(function(){return Object.values(t).reduce(function(e,t){return e[s.D[t.status].toLowerCase()].push(t),e},{completed:[],queued:[],uploading:[],failed:[]})},[t]),f=u.queued,v=u.uploading,m=(0,a.useCallback)(function(e){var t=r.length-e.length;return e.reduce(function(e,r,n){return e.then(function(){var e=o(r.file);!function(e,t,r){p.apply(this,arguments)}(r,e,t+n+1)})},Promise.resolve())},[o,r.length]);(0,a.useEffect)(function(){var e=20-v.length;if(f.length>0&&e>0){var t=f.slice(0,e);m(t),t.forEach(function(e){var t=o(e.file);(0,l.Z)({state:e,asset:t,beginUpload:n,endUpload:i})})}},[n,o,i,f,m,v])}},54112:function(e,t,r){"use strict";r.d(t,{w:function(){return o}});var n=r(36985),i=r(87360);function o(e,t){var r,o,a,u=null===(r=e.uploadError)||void 0===r?void 0:r.reason;if(u===i.Z.MIN_RESOLUTION)return t.t("upload:error.min_resolution");if(u===i.Z.UPLOAD_STATUS)return t.t("upload:error.try_again");if(u===i.Z.UPLOAD_FAILURE){var l=(0,n.BS)(e.file);return t.t("upload:error.upload_error",{mediumType:l})}if(u===i.Z.FILE_UNPROCESSABLE){var c=(0,n.BS)(e.file);return t.t("upload:error.file_unprocessable",{mediumType:c})}return u===i.Z.NO_UPLOAD_URL?t.t("upload:error.no_upload_url"):null!==(o=null===(a=e.uploadError)||void 0===a?void 0:a.errorMessage)&&void 0!==o?o:null}},87360:function(e,t,r){"use strict";r.d(t,{D:function(){return a},Z:function(){return o}});var n,i,o=((n={}).MIN_RESOLUTION="MIN_RESOLUTION",n.UPLOAD_FAILURE="UPLOAD_FAILURE",n.UPLOAD_STATUS="UPLOAD_STATUS",n.FILE_UNPROCESSABLE="FILE_UNPROCESSABLE",n.NO_UPLOAD_URL="NO_UPLOAD_URL",n.OTHER="OTHER",n),a=((i={})[i.QUEUED=0]="QUEUED",i[i.UPLOADING=1]="UPLOADING",i[i.COMPLETED=2]="COMPLETED",i[i.FAILED=3]="FAILED",i)},13884:function(e,t,r){"use strict";r.d(t,{L:function(){return _},b:function(){return w}});var n=r(94713),i=r(18529),o=r(36985),a=r(32971),u=r(6939),l=r(91341),c=r(54184),s=r(87360);function d(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var v=0;function m(e,t){var r,i,f,m,g,h,y,b,O,w,_,j,P,E,U,x,Z;switch(t.type){case"add-files":return(i=t.files.map(function(e){return{id:(0,c.M)("file","".concat(++v,"-").concat(e.name)),file:e,isValid:!0,metadata:{},status:s.D.QUEUED}})).length?p(p({},e),{},{activeFileId:null!==(r=e.activeFileId)&&void 0!==r?r:i[0].id,files:i.reduce(function(e,t){return p(p({},e),{},(0,n.Z)({},t.id,t))},e.files),fileOrdering:[].concat((0,u.Z)(i.map(function(e){return e.id})),(0,u.Z)(e.fileOrdering))}):e;case"remove-file":return function(e,t){var r=t.fileId,n=e.files,i=n[r],u=(0,a.Z)(n,[r].map(d)),c=e.activeUploads.find(function(e){return e.fileId===r});if(!i)return e;(0,l.M)({category:"media_upload_removed",action:(0,o.Fx)(i.file),label:null!==(f=(0,o.hy)(i.dimensions))&&void 0!==f?f:void 0,property:(0,o.BS)(i.file)});var s=e.activeFileId;if(s===i.id){var f,v,m=e.fileOrdering.indexOf(i.id),g=m<e.fileOrdering.length-1;s=null!==(v=e.fileOrdering[g?m+1:m-1])&&void 0!==v?v:null}return p(p({},e),{},{activeFileId:s,files:u,fileOrdering:e.fileOrdering.filter(function(e){return e!==r}),activeUploads:c?e.activeUploads.filter(function(e){return e!==c}):e.activeUploads})}(e,t);case"update-file":return f=t.fileId,m=t.update,(g=e.files[f])?p(p({},e),{},{files:p(p({},e.files),{},(0,n.Z)({},f,p(p({},g),m)))}):e;case"update-meta":return h=t.fileId,y=t.update,(b=e.files[h])?p(p({},e),{},{files:p(p({},e.files),{},(0,n.Z)({},h,p(p({},b),{},{metadata:p(p({},b.metadata),y)})))}):e;case"copy-meta":return O=t.copyAction,w=t.field,_=t.source,P=!!(Array.isArray(j=e.files[_].metadata[w])?j.length:j),p(p({},e),{},{files:e.fileOrdering.reduce(function(t,r){var i=e.files[r],o=p({},i.metadata);if("remove_from_all"!==O&&P){if(r===_)return t[r]=i,t;if("tags"===w){var a,l,c,s=null!==(a=null===(l=o.tags)||void 0===l?void 0:l.map(function(e){return e.name.trim().toLowerCase()}))&&void 0!==a?a:[],d=j.filter(function(e){var t=e.name;return!s.includes(t)});o.tags=[].concat((0,u.Z)(null!==(c=o.tags)&&void 0!==c?c:[]),(0,u.Z)(d))}else Object.assign(o,(0,n.Z)({},w,j))}else delete o[w];return t[r]=p(p({},i),{},{metadata:o}),t},{})});case"begin-upload":return E=t.fileId,U=t.upload,(null==(x=e.files[E])?void 0:x.status)===s.D.QUEUED&&U.fileId===x.id?p(p({},e),{},{files:p(p({},e.files),{},(0,n.Z)({},E,p(p({},x),{},{status:s.D.UPLOADING}))),activeUploads:[].concat((0,u.Z)(e.activeUploads),[U])}):e;case"end-upload":return function(e,t){var r=t.fileId,i=t.uploadTarget,o=t.result,u=e.files[r],l=e.activeUploads.find(function(e){return e.fileId==r});if((null==u?void 0:u.status)!==s.D.UPLOADING||(null==l?void 0:l.fileId)!==u.id)return e;var c=e.activeUploads.filter(function(e){return e!==l});if("cancelled"===o){var f=e.files,v=(f[r],(0,a.Z)(f,[r].map(d))),m=e.fileOrdering.filter(function(e){return e!==r});return p(p({},e),{},{activeUploads:c,files:v,fileOrdering:m})}if("success"===o&&!i)return Sentry.captureMessage("Attempting to mark file as uploaded, without providing upload target"),e;var g=p(p({},u),{},{target:null!=i?i:u.target,status:"success"===o?s.D.COMPLETED:s.D.FAILED,uploadError:"success"===o?void 0:o});return p(p({},e),{},{activeUploads:c,files:p(p({},e.files),{},(0,n.Z)({},r,g))})}(e,t);case"set-active":return(Z=t.fileId)&&e.fileOrdering.includes(Z)?p(p({},e),{},{activeFileId:Z}):e;default:return e}}var g=r(48282);function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var b={files:{},fileOrdering:[],activeUploads:[],browserIsSupported:(0,o.Lz)(),activeFileId:null},O=(0,i.createContext)(void 0),w=function(){return(0,i.useContext)(O)};function _(e){var t=e.children,r=(0,i.useReducer)(m,b),n=r[0],a=r[1],u=(0,i.useMemo)(function(){return{addFiles:function(e){return a({type:"add-files",files:e})},removeFile:function(e){return a({type:"remove-file",fileId:e})},updateFile:function(e,t){return a({type:"update-file",fileId:e,update:t})},updateMetadata:function(e,t){return a({type:"update-meta",fileId:e,update:t})},copyMetadata:function(e,t,r){return a({type:"copy-meta",source:e,copyAction:t,field:r})},beginUpload:function(e,t){return a({type:"begin-upload",fileId:e,upload:t})},endUpload:function(e,t,r){return a({type:"end-upload",fileId:e,result:t,uploadTarget:r})},setActiveFile:function(e){return a({type:"set-active",fileId:e})}}},[]),l=(0,i.useMemo)(function(){return y(y({},n),u)},[n,u]),c=(0,i.useRef)([]);return(0,i.useEffect)(function(){var e=(0,o.Bm)(l.activeUploads,c.current),t=e.added,r=e.removed;t.forEach(function(e){return e.begin()}),r.forEach(function(e){return e.end()}),c.current=l.activeUploads.slice()},[l.activeUploads]),(0,g.jsx)(O.Provider,{value:l,children:t})}},69732:function(e,t,r){"use strict";r.d(t,{Z:function(){return m},z:function(){return v}});var n=r(23810),i=r(94713),o=r(18529),a=r(38741),u=r(19647),l=r(65605),c=r(48282);function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach(function(t){(0,i.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var f={showAfterUploadModal:!1,mediumCount:0,flow:"first-upload",mediaType:"photo"},p=(0,o.createContext)(d(d({},f),{},{setPostUploadState:function(){},purgePostUploadState:function(){}}));function v(e){var t=e.children,r=(0,u.ZP)("postUpload",null,"session"),i=(0,n.Z)(r,2),s=i[0],v=i[1],m=(0,l.ZP)().user,g=(0,o.useCallback)(function(){v(null)},[v]),h=(0,o.useMemo)(function(){return d(d({},null!=s?s:f),{},{setPostUploadState:v,purgePostUploadState:g})},[g,v,s]);return(0,a.Z)(function(){var e;(null==m?void 0:m.attributes.media_count)&&(null===(e=localStorage)||void 0===e||e.removeItem("postUpload"))}),(0,c.jsx)(p.Provider,{value:h,children:t})}function m(){return(0,o.useContext)(p)}},60859:function(e,t,r){"use strict";var n=r(94713),i=r(32971),o=r(21841),a=r.n(o),u=r(18529),l=r(12198),c=r(46852),s=r(70597),d=r(33256),f=r(3130),p=r.n(f),v=r(48282),m=["label"],g=["className","theme"];function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}t.Z=(0,u.forwardRef)(function(e,t){var r,o,u=e.className,f=e.theme,h=void 0===f?"alien":f,b=(0,i.Z)(e,g),O=b.label;return(0,v.jsxs)("label",{className:a()(p().container,(0,c.Z)(e),u),children:["string"==typeof O?(0,v.jsx)(s.ZP,{size:"p$18",weight:"medium",color:"grey$7F7F7F",children:O}):O,(0,v.jsx)("input",y(y({ref:t},(b.label,r=(0,i.Z)(b,m),(0,c.K)(r))),{},{type:"checkbox"})),(0,v.jsx)("span",{className:a()(p().checkmark,(o={},(0,n.Z)(o,p().alien,"alien"===h),(0,n.Z)(o,p().shadow,"shadow"===h),o)),children:(0,v.jsx)(d.Z,{symbol:l.Z,width:20,height:20,paddingLeft:4,paddingTop:4})})]})})},1227:function(e){e.exports={container:"ProgressOverlay_container__T1tHq",preview:"ProgressOverlay_preview__5mb97",copyright:"ProgressOverlay_copyright__1pBx3",overlay:"ProgressOverlay_overlay___0Q0M",hasThumbnail:"ProgressOverlay_hasThumbnail__9jrgx",error:"ProgressOverlay_error__8u_LQ",errorIcon:"ProgressOverlay_errorIcon__xBSdx"}},46659:function(e){e.exports={mediaButton:"MediaInput_mediaButton__VMSv7",fileInput:"MediaInput_fileInput__vi2LJ"}},3130:function(e){e.exports={container:"Checkbox_container__Bxydr",checkmark:"Checkbox_checkmark__dLP8g",alien:"Checkbox_alien__29UZg",shadow:"Checkbox_shadow__zOaFJ"}}}]);
//# sourceMappingURL=93230-691f73097f425e3e.js.map